deep copies of the queues should be necessary
